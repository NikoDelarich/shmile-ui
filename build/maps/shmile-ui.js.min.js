{"version":3,"sources":["?"],"names":["CameraUtils","snap","idx","cheeseCb","p","zoomFrame","modalMessage","Config","ready_delay","scale4x6","maxw","maxh","s0","s1","w","h","photo_margin","window_width","$","window","width","window_height","height","overlay_delay","next_delay","cheese_delay","flash_duration","nice_delay","between_snap_delay","is_mobile","State","photoset","set_id","current_frame_idx","zoomed","ShmileStateMachine","photoView","socket","self","this","StateMachine","create","initial","events","name","from","to","callbacks","onconnected","animate","startButton","fadeIn","onenterready","resetState","onleaveready","onenterwaiting_for_photo","flashStart","emit","onphoto_saved","e","f","t","data","flashEnd","updatePhotoSet","web_url","setTimeout","fsm","photo_updated","onphoto_updated","finish_set","continue_partial_set","onenterreview_composited","showOverlay","next_set","onleavereview_composited","slideInNext","onchangestate","console","log","SocketLayer","io","connect","prototype","register","on","connected","filename","photo_saved","PhotoView","Backbone","View","extend","id","initialize","config","canvas","Raphael","frames","set","images","all","overlayImage","photoBorder","compositeDim","frameDim","compositeOrigin","compositeCenter","render","x","y","r","rect","attr","fill","push","frame_x","frame_y","frame","img","image","clone","translate","o","hide","toString","ret","length","join","img_src","cb","view","imgEl","frameEl","src","opacity","show","afterShowPhoto","dir","translation","onfinish","frameX","frameW","frameY","frameH","centerX","centerY","animSpeed","dx","dy","scaleFactor","scale","flashEffect","duration","undefined","remove","text","persistTime","animateSpeed","sideLength","fill-opacity","stroke-color","txt","font-size","font-weight","hideOverlay","ButtonView","buttonX","outerWidth","buttonY","outerHeight","css","top","left","buttonTriggerEvt","bind","button","currentTarget","fadeOut","document","trigger","ui_button_pressed","ready","mockSocket","append","layer","bv"],"mappings":"AAGA,QAASA,gBAUTA,YAAYC,KAAO,SAASC,EAAKC,GAC/BC,EAAEC,UAAUH,EAAK,MAEjBE,EAAEE,aAAa,SAAUC,OAAOC,YAAa,IAAK,WAChDJ,EAAEE,aAAa,IAAK,IAAM,IAAK,WAC7BF,EAAEE,aAAa,IAAK,IAAM,IAAM,WAC9BF,EAAEE,aAAa,IAAK,IAAM,IAAK,WAC7BH,aAWVH,YAAYS,SAAW,SAASC,EAAMC,GAClC,GAAIC,GAAK,IACLC,EAAKH,EAAKC,CAGd,OAAUE,IAAND,GACQE,EAAU,EAAPH,EAAS,EAAGI,EAAGJ,IAElBG,EAAGJ,EAAMK,EAAU,EAAPL,EAAS,GAIrC,IAAIH,SACFS,aAAc,GACdC,aAAcC,EAAEC,QAAQC,QACxBC,cAAeH,EAAEC,QAAQG,SAAW,GACpCC,cAAe,IACfC,WAAY,IACZC,aAAc,IACdC,eAAgB,IAChBlB,YAAa,IACbmB,WAAY,IAMZC,mBAAoB,IAGpBC,WAAW,GAITC,OACFC,YACAC,OAAQ,KACRC,kBAAmB,EACnBC,OAAQ,KAoBVC,oBAAqB,SAASC,EAAWC,EAAQP,EAAOvB,GACtD,GAAI+B,GAAOC,IAMX,OALAD,GAAKF,UAAYA,EACjBE,EAAKD,OAASA,EACdC,EAAKR,MAAQA,EACbQ,EAAK/B,OAASA,EAEPiC,aAAaC,QAClBC,QAAS,UACTC,SACIC,KAAM,YAAaC,KAAM,UAAWC,GAAI,UACxCF,KAAM,oBAAqBC,KAAM,QAASC,GAAI,sBAC9CF,KAAM,cAAeC,KAAM,oBAAqBC,GAAI,iBACpDF,KAAM,gBAAiBC,KAAM,eAAgBC,GAAI,eACjDF,KAAM,uBAAwBC,KAAM,aAAcC,GAAI,sBACtDF,KAAM,aAAcC,KAAM,aAAcC,GAAI,sBAC5CF,KAAM,WAAYC,KAAM,oBAAqBC,GAAI,UAErDC,WACEC,YAAa,WACXV,EAAKF,UAAUa,QAAQ,KAAM,WAC3BC,YAAYC,YAGhBC,aAAc,WACZd,EAAKF,UAAUiB,cAEjBC,aAAc,aAEdC,yBAA0B,WACxBpD,SAAW,WACTmC,EAAKF,UAAU9B,aAAa,UAAWC,EAAOkB,cAC9Ca,EAAKF,UAAUoB,aACfnB,EAAOoB,KAAK,QAAQ,IAEtBzD,YAAYC,KAAKqC,EAAKR,MAAMG,kBAAmB9B,WAEjDuD,cAAe,SAASC,EAAGC,EAAGC,EAAGC,GAG/BxB,EAAKF,UAAU2B,WACfzB,EAAKF,UAAU4B,eAAeF,EAAKG,QAAS3B,EAAKR,MAAMG,kBAAmB,WACxEiC,WAAW,WACTC,IAAIC,iBACH7D,EAAOqB,uBAGdyC,gBAAiB,WACf/B,EAAKF,UAAU2B,WAEqB,GAAhCzB,EAAKR,MAAMG,kBACbkC,IAAIG,cAIJhC,EAAKR,MAAMG,mBAAqBK,EAAKR,MAAMG,kBAAoB,GAAK,EACpEkC,IAAII,yBAGRC,yBAA0B,WACxBnC,EAAOoB,KAAK,aACZnB,EAAKF,UAAUqC,aAAY,GAC3BP,WAAW,WAAaC,IAAIO,YAAcnE,EAAOiB,aAEnDmD,yBAA0B,WAExBrC,EAAKF,UAAUa,QAAQ,OACvBX,EAAKF,UAAU9B,aAAa,QAASC,EAAOoB,WAAY,IAAK,WAAYW,EAAKF,UAAUwC,iBAE1FC,cAAe,SAASlB,EAAGC,EAAGC,GAC5BiB,QAAQC,IAAI,sBAAsBpB,EAAE,yBAA2BC,EAAI,OAASC,OASpF,IAAImB,aAAc,SAASC,EAAId,GAC7B5B,KAAKF,OAAS4C,EAAGC,QAAQ,KACzB3C,KAAK4B,IAAMA,EAIba,aAAYG,UAAUC,SAAW,WAC/B,GAAI9C,GAAOC,IACXA,MAAKF,OAAOgD,GAAG,UAAW,SAASvB,GACjCgB,QAAQC,IAAI,UAAYjB,KAG1BvB,KAAKF,OAAOgD,GAAG,UAAW,WACxBP,QAAQC,IAAI,iBACZzC,EAAK6B,IAAImB,cAGX/C,KAAKF,OAAOgD,GAAG,iBAAkB,WAC/BP,QAAQC,IAAI,wBAIdxC,KAAKF,OAAOgD,GAAG,cAAe,SAASvB,GACrCgB,QAAQC,IAAI,oBAAoBjB,EAAKyB,UACrCjD,EAAK6B,IAAIqB,YAAY1B,KAIzB,IAAI2B,WAAYC,SAASC,KAAKC,QAC5BC,GAAI,YAEJC,WAAY,SAASC,GACnBxD,KAAKwD,OAASA,EACdxD,KAAKyD,OAAS,GAAIC,SAAQ,WAAY1D,KAAKwD,OAAO9E,aAAcsB,KAAKwD,OAAO1E,eAC5EkB,KAAK2D,OAAS3D,KAAKyD,OAAOG,MAC1B5D,KAAK6D,OAAS7D,KAAKyD,OAAOG,MAC1B5D,KAAK8D,IAAM9D,KAAKyD,OAAOG,MACvB5D,KAAK+D,aAAe,KACpB/D,KAAKgE,YAAc,EACnBhE,KAAKiE,aAAe,KACpBjE,KAAKkE,SAAW,KAChBlE,KAAKmE,gBAAkB,KACvBnE,KAAKoE,gBAAkB,MAGzBC,OAAQ,WACN,GAAI9F,GAAIyB,KAAKwD,OAAO9E,aAAesB,KAAKwD,OAAO/E,aAC3CD,EAAIwB,KAAKwD,OAAO1E,cAAgBkB,KAAKwD,OAAO/E,YAChDuB,MAAKiE,aAAexG,YAAYS,SAASK,EAAGC,GAC5CwB,KAAKmE,iBACDG,GAAItE,KAAKwD,OAAO9E,aAAesB,KAAKiE,aAAa1F,GAAK,EACtDgG,GAAIvE,KAAKwD,OAAO1E,cAAgBkB,KAAKiE,aAAazF,GAAK,GAE3DwB,KAAKoE,iBACDE,EAAGtE,KAAKmE,gBAAgBG,EAAKtE,KAAKiE,aAAa1F,EAAE,EACjDgG,EAAGvE,KAAKmE,gBAAgBI,EAAKvE,KAAKiE,aAAazF,EAAE,EAErD,IAAIgG,GAAIxE,KAAKyD,OAAOgB,KAAKzE,KAAKmE,gBAAgBG,EAAGtE,KAAKmE,gBAAgBI,EAAGvE,KAAKiE,aAAa1F,EAAGyB,KAAKiE,aAAazF,EAEhHgG,GAAEE,MAAMC,KAAQ,UAEhB3E,KAAK8D,IAAIc,KAAKJ,GAGdxE,KAAKgE,YAAchE,KAAKiE,aAAa1F,EAAI,EAGzC,IAAIsG,GAAU7E,KAAKmE,gBAAgBG,EAAItE,KAAKgE,YACxCc,EAAU9E,KAAKmE,gBAAgBI,EAAIvE,KAAKgE,WAC5ChE,MAAKkE,UACD3F,GAAIyB,KAAKiE,aAAa1F,EAAK,EAAEyB,KAAKgE,aAAc,EAChDxF,GAAIwB,KAAKiE,aAAazF,EAAK,EAAEwB,KAAKgE,aAAc,EAEpD,IAAIe,GAAQ/E,KAAKyD,OAAOgB,KAAKI,EAASC,EAAS9E,KAAKkE,SAAS3F,EAAGyB,KAAKkE,SAAS1F,EAC9EuG,GAAML,MAAMC,KAAQ,SACpB,IAAIK,GAAMhF,KAAKyD,OAAOwB,MAAM,KAAMJ,EAASC,EAAS9E,KAAKkE,SAAS3F,EAAGyB,KAAKkE,SAAS1F,EAEnFwB,MAAK6D,OAAOe,KAAKI,GACjBhF,KAAK2D,OAAOiB,KAAKG,GACjB/E,KAAK8D,IAAIc,KAAKI,GACdhF,KAAK8D,IAAIc,KAAKG,GAEdA,EAAQA,EAAMG,QACdF,EAAMA,EAAIE,QACVH,EAAMI,UAAUnF,KAAKkE,SAAS3F,EAAIyB,KAAKgE,YAAa,GACpDgB,EAAIG,UAAUnF,KAAKkE,SAAS3F,EAAIyB,KAAKgE,YAAa,GAClDhE,KAAK2D,OAAOiB,KAAKG,GACjB/E,KAAK6D,OAAOe,KAAKI,GACjBhF,KAAK8D,IAAIc,KAAKG,GACd/E,KAAK8D,IAAIc,KAAKI,GAEdD,EAAQA,EAAMG,QACdF,EAAMA,EAAIE,QACVH,EAAMI,YAAYnF,KAAKkE,SAAS3F,EAAIyB,KAAKgE,aAAchE,KAAKkE,SAAS1F,EAAIwB,KAAKgE,aAC9EgB,EAAIG,YAAYnF,KAAKkE,SAAS3F,EAAIyB,KAAKgE,aAAchE,KAAKkE,SAAS1F,EAAIwB,KAAKgE,aAC5EhE,KAAK2D,OAAOiB,KAAKG,GACjB/E,KAAK6D,OAAOe,KAAKI,GACjBhF,KAAK8D,IAAIc,KAAKG,GACd/E,KAAK8D,IAAIc,KAAKI,GAEdD,EAAQA,EAAMG,QACdF,EAAMA,EAAIE,QACVH,EAAMI,UAAUnF,KAAKkE,SAAS3F,EAAIyB,KAAKgE,YAAa,GACpDgB,EAAIG,UAAUnF,KAAKkE,SAAS3F,EAAIyB,KAAKgE,YAAa,GAClDhE,KAAK2D,OAAOiB,KAAKG,GACjB/E,KAAK6D,OAAOe,KAAKI,GACjBhF,KAAK8D,IAAIc,KAAKG,GACd/E,KAAK8D,IAAIc,KAAKI,EAGd,IAAII,GAAIpF,KAAKyD,OAAOwB,MAChB,sBACAjF,KAAKmE,gBAAgBG,EACrBtE,KAAKmE,gBAAgBI,EACrBvE,KAAKiE,aAAa1F,EAClByB,KAAKiE,aAAazF,EACtBwB,MAAK8D,IAAIc,KAAKQ,GACdpF,KAAK+D,aAAeqB,EAGpBpF,KAAK8D,IAAIuB,OACTrF,KAAK8D,IAAIqB,WAAWnF,KAAKwD,OAAO9E,aAAc,IAGhD4G,SAAU,WAMR,MALAC,QACAA,IAAIX,KAAK,sBAAwB5E,KAAK8D,IAAI0B,QAC1CD,IAAIX,KAAK,yBAA2B5E,KAAK2D,OAAO6B,QAChDD,IAAIX,KAAK,uBAAyB5E,KAAK8D,IAAI,GAAGY,KAAK,SAAW,IAAM1E,KAAK8D,IAAI,GAAGY,KAAK,WACrFa,IAAIX,KAAK,mBAAqB5E,KAAKkE,SAAS3F,EAAI,IAAMyB,KAAKkE,SAAS1F,GAC7D+G,IAAIE,KAAK,OAYlBhE,eAAgB,SAASiE,EAAS/H,EAAKgI,GACrC,GAAIC,GAAO5F,KACP6F,EAAQD,EAAK/B,OAAOlG,GACpBmI,EAAUF,EAAKjC,OAAOhG,EAE1BkI,GAAMnB,MAAMqB,IAAOL,EAASM,QAAW,IACvCH,EAAMI,MAEN,IAAIC,GAAiB,WAEnBJ,EAAQT,OACRxH,EAAEC,UAAUH,EAAK,MAAOgI,GAE1BE,GAAMnF,SAASsF,QAAW,GAAI,IAAKE,IAQrCxF,QAAS,SAASyF,EAAKR,GACT,OAARQ,GACFnG,KAAK8D,IAAImC,OACTjG,KAAK6D,OAAOwB,OACZrF,KAAK+D,aAAasB,OAClBrF,KAAK8D,IAAIpD,SACP0F,YAAepG,KAAKwD,OAAO9E,aAAa,MACvC,IAAM,KAAMiH,IACE,QAARQ,GACTnG,KAAK8D,IAAIpD,SACP0F,YAAepG,KAAKwD,OAAO9E,aAAa,MACvC,IAAM,KAAMiH,IAkBnB7H,UAAW,SAASH,EAAKwI,EAAKE,GAC1B,GAAIT,GAAO5F,KAGP+E,GAFY/E,KAAK8D,IAAInG,GAEbqC,KAAK2D,OAAOhG,IACpB2I,EAASvB,EAAML,KAAK,KACpB6B,EAASxB,EAAML,KAAK,SACpB8B,EAASzB,EAAML,KAAK,KACpB+B,EAAS1B,EAAML,KAAK,UACpBgC,EAAUJ,EAASC,EAAO,EAC1BI,EAAUH,EAASC,EAAO,EAE1BG,EAAY,IAGZC,EAAK7G,KAAKoE,gBAAgBE,EAAIoC,EAC9BI,EAAK9G,KAAKoE,gBAAgBG,EAAIoC,EAC9BI,EAAc/G,KAAKiE,aAAa1F,EAAIyB,KAAKkE,SAAS3F,CAE1C,SAAR4H,GAAiB5G,MAAMI,QACvBoH,EAAc,EACdF,GAAMtH,MAAMI,OAAOkH,GACnBC,GAAMvH,MAAMI,OAAOmH,GACnBlB,EAAK9B,IAAIpD,SACLsG,OAAU,EAAG,EAAGpB,EAAKxB,gBAAgBE,EAAGsB,EAAKxB,gBAAgBG,GAAGkB,KAAK,MACtEmB,EAAW,SAAU,WACpBhB,EAAK9B,IAAIpD,SACL0F,YAAeS,EAAG,IAAIC,GACvBF,EAAW,KAAMP,KAGxB9G,MAAMI,OAAS,MACA,QAARwG,IACPP,EAAK9B,IAAIpD,SACL0F,YAAeS,EAAG,IAAIC,GACvBF,EAAW,KAAM,WAChBhB,EAAK9B,IAAIpD,SACLsG,OAAUD,EAAaA,EAAanB,EAAKxB,gBAAgBE,EAAGsB,EAAKxB,gBAAgBG,GAAGkB,KAAK,MAC1FmB,EAAW,SAAUP,KAG5B9G,MAAMI,QACFkH,GAAIA,EACJC,GAAIA,EACJC,YAAaA,KAQzB1E,YAAa,WACTrC,KAAKc,aACLd,KAAKjC,aAAa,SAClBiC,KAAK8D,IAAIuB,OACTrF,KAAK8D,IAAIqB,UAAsC,GAA3BnF,KAAKwD,OAAO9E,aAAkB,GAClDsB,KAAKU,QAAQ,KAAM,WACjB/B,EAAE,iBAAiBiC,YAOzBE,WAAY,WACRvB,OACIC,YACAC,OAAQ,KACRC,kBAAmB,EACnBC,OAAQ,OAOhBsH,YAAa,SAASC,GACHC,SAAbD,IAA0BA,EAAW,IACzC,IAAIzC,GAAOzE,KAAKyD,OAAOgB,KAAK,EAAG,EAAGzE,KAAKwD,OAAO9E,aAAcsB,KAAKwD,OAAO1E,cACxE2F,GAAKC,MAAMC,KAAQ,QAASqB,QAAW,IACvCvB,EAAK/D,SAASsF,QAAW,GAAIkB,EAAU,IAAK,WAC1CzC,EAAK/D,SAASsF,QAAW,GAAIkB,EAAU,KACvCzC,EAAK2C,YAITnG,WAAY,SAASiG,GACFC,SAAbD,IAA0BA,EAAW,KACzClH,KAAKyE,KAAOzE,KAAKyD,OAAOgB,KAAK,EAAG,EAAGzE,KAAKwD,OAAO9E,aAAcsB,KAAKwD,OAAO1E,eACzEkB,KAAKyE,KAAKC,MAAMC,KAAQ,QAASqB,QAAW,IAC5ChG,KAAKyE,KAAK/D,SAASsF,QAAW,GAAIkB,EAAU,MAG9C1F,SAAU,SAAS0F,GACAC,SAAbD,IAA0BA,EAAW,IACzC,IAAInH,GAAOC,IACXA,MAAKyE,KAAK/D,SAASsF,QAAW,GAAIkB,EAAU,IAAK,WAC/CnH,EAAKqH,YAOTrJ,aAAc,SAASsJ,EAAMC,EAAaC,EAAc5B,GACpD,GAAqBwB,SAAjBI,EAA8B,GAAIA,GAAe,GACrD,IAAoBJ,SAAhBG,EAA6B,GAAIA,GAAc,GAEnD,IAAIE,GAAyC,GAA5BxH,KAAKwD,OAAO1E,cACzBwF,GAAKtE,KAAKwD,OAAO9E,aAAe8I,GAAY,EAC5CjD,GAAKvE,KAAKwD,OAAO1E,cAAgB0I,GAAY,EAC7C1D,EAAM9D,KAAKyD,OAAOG,MAClBY,EAAIxE,KAAKyD,OAAOgB,KAAKH,EAAGC,EACxBiD,EACAA,EACA,GACJhD,GAAEE,MAAMC,KAAQ,OACR8C,eAAgB,GAChBC,eAAgB,UACxB5D,EAAIc,KAAKJ,EACT,IAAImD,GAAM3H,KAAKyD,OAAO4D,KAAK/C,EAAIkD,EAAW,EAAGjD,EAAIiD,EAAW,EAAGH,EAC/DM,GAAIjD,MAAMC,KAAQ,QACdiD,YAAa,KACbC,cAAe,SAEnB/D,EAAIc,KAAK+C,GACT7D,EAAIY,MAAMsB,QAAW,IACrBlC,EAAIpD,SACAsF,QAAW,EACXgB,MAAS,UACTY,YAAa,MACdL,EAAc,IAGT5F,YAAW,WAEfgG,EAAIP,SACJ5C,EAAE4C,SACEzB,GAAIA,KACT2B,EAAaxD,IAOpB5B,YAAa,SAASxB,GAClBV,KAAK+D,aAAakC,OACdvF,GAEFV,KAAK+D,aAAarD,SAASsF,QAAU,GAAIhG,KAAKwD,OAAOxE,gBAO3D8I,YAAa,SAASpH,GACpB,GAAIkF,GAAO5F,IACPU,GACFV,KAAK+D,aAAarD,SAASsF,QAAU,GAAIhG,KAAKwD,OAAOxE,cAAe,WAClE4G,EAAK7B,aAAasB,SAGpBrF,KAAK+D,aAAasB,UAKpB0C,WAAa,YACjBA,YAAWnF,UAAUyB,OAAS,WAE5B1D,YAAchC,EAAE,sBAChB,IAAIqJ,IAAWhK,OAAOU,aAAeiC,YAAYsH,cAAc,EAC3DC,GAAWlK,OAAOc,cAAgB6B,YAAYwH,eAAe,CAEjExH,aAAY0E,OAGZ1E,YAAYyH,KAAKC,IAAOH,EAASI,KAAQN,GAEzC,IAAIO,GAAmBvK,OAAOsB,UAAY,WAAa,OAEvDqB,aAAY6H,KAAKD,EAAkB,SAASnH,GAC1C,GAAIqH,GAAS9J,EAAEyC,EAAEsH,cACjBD,GAAOE,QAAQ,KACfhK,EAAEiK,UAAUC,QAAQ,uBAGtBlK,EAAEiK,UAAUJ,KAAK,oBAAqB,WACpCjG,QAAQC,IAAI,yBACZZ,IAAIkH,uBAKRnK,EAAEC,QAAQmK,MAAM,WAEd,GAAIC,GAAarK,EAAE,wBACnBA,GAAE,QAAQsK,OAAOD,GAEjBpK,OAAOkB,OAA4B,mBAAXA,QAA0BkJ,EAAapK,OAAOkB,OACtElB,OAAO8D,GAAK9D,OAAO8D,KACjBC,QAAS,WAAa,MAAO/D,QAAOkB,SAGtClB,OAAOf,EAAI,GAAIqF,WAAUtE,OAAOZ,QAChCY,OAAOgD,IAAM,GAAIhC,oBAAmBhB,OAAOf,EAAGe,OAAOkB,OAAQlB,OAAOW,MAAOX,OAAOZ,OAClF,IAAIkL,GAAQ,GAAIzG,aAAYC,GAAI9D,OAAOgD,IACvCsH,GAAMrG,WAENsG,GAAK,GAAIpB,YACToB,GAAG9E,SACHxG,EAAEwG","file":"shmile-ui.js","sourcesContent":[null],"sourceRoot":"/source/"}